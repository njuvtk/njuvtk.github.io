import{e as E}from"./index.modern.CkIAsQri.js";function v(){return v=Object.assign?Object.assign.bind():function(s){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(s[l]=e[l])}return s},v.apply(this,arguments)}function b(s){return s.localName!=="title"&&!s.matches("[data-swup-theme]")}function A(s,n){return s.outerHTML===n.outerHTML}function O(s){return s.matches("link[rel=stylesheet][href]")}class j extends E{constructor(n={}){var e;super(),e=this,this.name="SwupHeadPlugin",this.requires={swup:">=4.6"},this.defaults={persistTags:!1,persistAssets:!1,awaitAssets:!1,timeout:3e3},this.options=void 0,this.updateHead=async function(l,{page:{}}){const w=l.to.document,{removed:H,added:y}=function(r,f,{shouldPersist:g=()=>!1}={}){const d=Array.from(r.children),i=Array.from(f.children),u=(c=d,i.reduce((t,a,h)=>(c.some(p=>A(a,p))||t.push({el:a,index:h}),t),[]));var c;const o=function(t,a){return t.reduce((h,p)=>(a.some(x=>A(p,x))||h.push({el:p}),h),[])}(d,i);return o.reverse().filter(({el:t})=>b(t)).filter(({el:t})=>!g(t)).forEach(({el:t})=>r.removeChild(t)),u.filter(({el:t})=>b(t)).forEach(({el:t,index:a=0})=>{r.insertBefore(t.cloneNode(!0),r.children[a+1]||null)}),{removed:o.map(({el:t})=>t),added:u.map(({el:t})=>t)}}(document.head,w.head,{shouldPersist:r=>e.isPersistentTag(r)});e.swup.log(`Removed ${H.length} / added ${y.length} tags in head`);const T=(m=document.documentElement).lang!==(P=w.documentElement).lang?(m.lang=P.lang,m.lang||null):null;var m,P;if(T&&e.swup.log(`Updated lang attribute: ${T}`),e.options.awaitAssets){const r=function(f,g=0){return f.filter(O).map(d=>function(i,u=0){const c=o=>{i.sheet?o():setTimeout(()=>c(o),10)};return new Promise(o=>{c(()=>o(i)),u>0&&setTimeout(()=>o(i),u)})}(d,g))}(y,e.options.timeout);r.length&&(e.swup.log(`Waiting for ${r.length} assets to load`),await Promise.all(r))}},this.options=v({},this.defaults,n),this.options.persistAssets&&!this.options.persistTags&&(this.options.persistTags="link[rel=stylesheet], script[src], style")}mount(){this.before("content:replace",this.updateHead)}isPersistentTag(n){const{persistTags:e}=this.options;return typeof e=="function"?e(n):typeof e=="string"&&e.length>0?n.matches(e):!!e}}export{j as default};
